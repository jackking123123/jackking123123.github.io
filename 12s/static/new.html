<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TokenPocket TRON Wallet Address</title>
</head>
<body>
    <h1>TRON Wallet Address</h1>
    <p id="walletAddress">Connecting to TokenPocket...</p>

    <script>
        async function getWalletAddress() {
            // 检查是否在 TokenPocket 中打开
            if (typeof window.tronLink === 'undefined') {
                document.getElementById('walletAddress').innerText = '请通过 TokenPocket 打开该页面！';
                return;
            }

            try {
                const tronLink = window.tronLink;
                const tronWeb = tronLink.tronWeb;

                // 确保钱包准备好
                if (!tronWeb || !tronWeb.ready) {
                    document.getElementById('walletAddress').innerText = 'TokenPocket 钱包尚未准备好。';
                    return;
                }

                // 请求连接的钱包地址
                const accounts = await tronWeb.request({ method: 'tron_requestAccounts' });
                const walletAddress = accounts[0];

                // 显示钱包地址
                document.getElementById('walletAddress').innerText = `Connected TRON Wallet Address: ${walletAddress}`;
            } catch (error) {
                console.error('连接钱包失败:', error);
                document.getElementById('walletAddress').innerText = '连接钱包时发生错误，请查看控制台。';
            }
        }

        // 页面加载时自动调用函数
        window.addEventListener('load', getWalletAddress);
    </script>
</body>
</html>
